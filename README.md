# 🛡️ D.M.I. - DotNet Mod Inspector
> **原名：Duckov Mod Inspector**
>
> **"See what your mods can do." (看看你的 Mod 到底能干什么)**

![Version](https://img.shields.io/badge/version-1.5.0-blue) ![Platform](https://img.shields.io/badge/platform-Windows-blue) ![License](https://img.shields.io/badge/license-MIT-green)

**D.M.I.** 是一个针对 Unity/C# 游戏模组（Mods）的**静态行为审计工具**。

它不像传统杀毒软件那样只通过“病毒库”匹配，而是像 **Android/iOS 的权限管理系统** 一样，深入扫描 `.dll` 文件内部，将模组的**潜藏能力**（联网、读写文件、执行命令等）直观地展示给你，把**知情权**还给玩家。

**支持游戏：** 适用于所有基于 C#/.NET 的游戏（如《逃离塔科夫(SPT/Live)》、《致命公司 (Lethal Company)》、《城市：天际线 2》、《戴森球计划》等）。

---

## ✨ v1.5 核心特性 (New!)

### 1. 📱 现代化仪表盘 (Card UI)
告别晦涩的控制台文本。v1.5 引入了**卡片式设计**，将每个文件的审计结果折叠在独立的卡片中。
- 🟢 **安全/纯净**：无敏感权限。
- 🔵 **功能型**：包含基础业务权限（如为了自动更新而联网）。
- 🟠 **需注意**：包含与其功能不匹配的权限（如皮肤 Mod 却要联网）。
- 🚫 **高风险**：发现混淆代码或恶意特征。

### 2. 🧠 意图推理引擎 (Context Engine)
单纯的“联网权限”并不可怕，可怕的是它连去哪。
- **智能分析**：如果检测到 `Socket` + `127.0.0.1`，DMI 会告诉你这是**“本地小地图服务”**（🟢 安全）。
- **风险识别**：如果检测到 `Socket` + `cmd.exe`，DMI 会报警这是**“远程控制木马”**（🚫 高危）。

### 3. 🎲 香农熵反混淆检测 (Entropy Check)
黑客试图通过加密或混淆代码来绕过检测？
- DMI 内置**信息熵算法**，如果文件混乱度（Entropy）超过阈值（>7.2），即被标记为**“高强度混淆/疑似加密”**，让恶意代码无处遁形。

### 4. 🌐 通用化审计内核
不再局限于单一游戏。现在的核心引擎基于通用 .NET 反射原理，可以审计任何 C# 编写的程序集。

---

## 🚀 如何使用

1.  下载最新版本的 `DMI.exe`。
2.  运行程序。
3.  将你下载的 **Mod 文件夹** 或 **.dll 文件** 直接拖入 DMI 窗口。
4.  查看生成的权限仪表盘。

![Screenshot Placeholder](screenshot.png)
*(建议在此处放一张软件运行截图)*

---

## 🚦 如何解读报告

| 状态图标 | 含义 | 建议操作 |
| :--- | :--- | :--- |
| 🔵 **功能型 (Info)** | 包含常见的 API 调用，如文件读写、基础联网。 | 通常是安全的，属于 Mod 的正常功能。 |
| ⚠️ **需注意 (Warning)** | 包含敏感权限（如读取 SteamID、Socket 连接、反射）。 | **人工复核**。如果这是一个简单的“改枪 Mod”却出现了此状态，请立即删除。 |
| 🚫 **高风险 (Danger)** | 发现明确的恶意特征（如 Webhook 偷号、挖矿、IP 追踪）或代码被加密。 | **建议删除**。除非你完全信任该作者，否则不要运行。 |
| ✅ **纯净 (Safe)** | 未检测到任何敏感 API 调用。 | 放心使用。 |

---

## 🔍 技术细节 (For Geeks)

DMI 对 `.dll` 二进制文件进行异步静态分析，主要关注以下五大维度：

* **🌐 Network (网络)**: 扫描 `HttpClient`, `Socket`, `UnityWebRequest` 以及硬编码的 URL（如 Discord Webhook）。
* **📂 FileSystem (文件)**: 扫描文件读写、删除以及 `Environment.GetFolderPath`（敏感路径获取）。
* **⚙️ System (系统)**: 扫描 `Process.Start` (启动外部 EXE), `Registry` (注册表操作)。
* **🎭 Reflection (反射)**: 扫描 `Method.Invoke`, `Assembly.Load`。这是恶意软件隐藏自身意图的常用手段。
* **🆔 Privacy (隐私)**: 扫描针对 `SteamID`, `Session`, `Wallet` 等敏感信息的读取操作。

---

## ⚠️ 免责声明

1.  **辅助工具**：DMI 是一个审计工具，通过“权限透明化”来辅助你做决策。**它不能 100% 保证一个文件是安全的**（例如高级的逻辑炸弹）。
2.  **误报可能**：某些高级 Mod（如联机插件、大型前置库）确实需要大量敏感权限。请结合“意图分析”提示进行判断。
3.  **使用责任**：作者不对因使用本工具或使用被审计 Mod 造成的任何损失负责。

---

## 🤝 贡献与反馈

本项目旨在为玩家社区建立第一道防线。
如果你发现了新的恶意 Mod 变种，或者 DMI 出现了误报，请提交 Issue 反馈，帮助我们更新规则库。

**Made with ❤️ by Godot Engine**
